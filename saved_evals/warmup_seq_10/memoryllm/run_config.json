{
  "run_name": "memoryllm",
  "seed": 42,
  "distributed": {
    "cuda_visible_devices": "0,1,2,3",
    "nproc_per_node": 4,
    "master_port": 29512
  },
  "data": {
    "eligible_target_types_val_ood": [
      "fact_subcategories"
    ],
    "val_ood_datasets": [
      "../../data/counterfact_gnm/data/test/test_unseen_categories_0.json",
      "../../data/counterfact_gnm/data/test/test_unseen_categories_1.json",
      "../../data/counterfact_gnm/data/test/test_unseen_categories_2.json"
    ],
    "training_datasets": null,
    "val_id_path": null,
    "eligible_target_types_train": null,
    "eligible_target_types_val_id": null,
    "add_refusal_to_user_message": false,
    "holdout_targets_train": null,
    "holdout_target_values_train": null,
    "holdout_targets_val_id": null,
    "holdout_target_values_val_id": null,
    "holdout_targets_val_ood": [
      "us_cities_or_states",
      "non_us_cities_or_states",
      "country",
      "major_western_european_languages",
      "eastern_european_mediterranean_languages",
      "asian_middle_eastern_languages_and_pacific",
      "tech_industrial_or_gaming_company",
      "TV_entertainment_or_news_organization",
      "car_company",
      "music_or_art_related_occupation",
      "sports_related_occupation",
      "politics_entertainment_religion_related_occupation"
    ],
    "holdout_target_values_val_ood": null,
    "train_limit": null,
    "val_limit": null
  },
  "sampling": {
    "num_paraphrase_from_facts_to_learn": 2,
    "num_true_output_neighbor_from_facts_to_learn": 1,
    "num_paraphrase_from_facts_to_refuse": 2,
    "num_true_output_neighbor_from_facts_to_refuse": 1,
    "num_paraphrase_from_other_facts": 1,
    "num_true_output_neighbor_from_other_facts": 0,
    "max_total_io_pairs_per_sample": 4,
    "num_io_pairs_to_chunk": 2,
    "max_new_tokens": 8,
    "num_in_future_to_pull_back_future_paraphrase": 4,
    "num_in_past_to_pull_forward_true_output_neighbor": 4,
    "num_in_past_to_pull_forward_paraphrase_not_target_to_learn": 4
  },
  "opt": null,
  "model": {
    "model": "memoryllm_chat",
    "model_path": "YuWangX/memoryllm-8b-chat",
    "tokenizer_path": "YuWangX/memoryllm-8b-chat",
    "model_state_dict_path": null,
    "checkpoint_dict_path": null,
    "pretty_name": "MemoryLLM"
  },
  "loop": {
    "sequence_length": 10,
    "sequence_length_validation": null,
    "unlearning": false,
    "early_stop": true,
    "window_size": 6,
    "stride": 6,
    "max_risk_score_threshold": 80000,
    "start_epoch": 0,
    "starting_global_step": 0,
    "plot_every_n_epochs": 1,
    "checkpoint_every_n_epochs": 2,
    "max_checkpoints": 5,
    "completions_batch_sample_count": 1,
    "early_stop_patience": 5,
    "early_stop_min_delta": 0.01,
    "max_epochs": 100
  },
  "log": {
    "wandb_project": "gnm_draft_experiments",
    "batch_log_interval": 1
  }
}